
* Create ZTABEL_TASK1 data element and show it in ALV Report


TABLES :ZTABEL_TASK1.

TYPES : BEGIN OF R1,
  ORDER_NUM TYPE ZDATA1,
  ORDER_ID  TYPE ZDATA2,
  CUSTOMER_NUM TYPE ZDATA4,
  COMPANY_CODE TYPE ZDATA5,
  PIECES TYPE ZDATA6,
  TEXT  TYPE ZDATA7,

  END OF R1.

  DATA :IT TYPE STANDARD TABLE OF R1,
        WA TYPE R1,
        IT_FIELDCAT TYPE SLIS_T_FIELDCAT_ALV,
       WA_FIELDCAT TYPE SLIS_FIELDCAT_ALV,
        it_top TYPE slis_t_listheader,
       wa_top TYPE slis_listheader.


 START-OF-SELECTION.
PERFORM GET_DATA.
PERFORM BUILD_FILDCAT.
PERFORM DISPLAY_DATA.

FORM GET_DATA.

   SELECT * FROM ZTABEL_TASK1
     INTO CORRESPONDING FIELDS OF TABLE @IT.
*     WHERE ZDATA1 IN @ORDER_NUM AND  ZDATA2 IN @ORDER_ID.



   ENDFORM.



   FORM BUILD_FILDCAT.

     WA_FIELDCAT-FIELDNAME = 'ORDER_NUM'.
  WA_FIELDCAT-SELTEXT_M = 'Purchase Order '.
  WA_FIELDCAT-COL_POS = 1.
*  WA_FIELDCAT-NO_OUT = 'X'.
*  WA_FIELDCAT-EDIT = 'X'.
  APPEND WA_FIELDCAT TO IT_FIELDCAT.
  CLEAR WA_FIELDCAT.

    WA_FIELDCAT-FIELDNAME = 'ORDER_ID'.
  WA_FIELDCAT-SELTEXT_M = 'Company Code'.
  WA_FIELDCAT-COL_POS = 2.
  APPEND WA_FIELDCAT TO IT_FIELDCAT.
  CLEAR WA_FIELDCAT.

    WA_FIELDCAT-FIELDNAME = 'DATE '.
  WA_FIELDCAT-SELTEXT_M = 'Date'.
  WA_FIELDCAT-COL_POS = 3.
  APPEND WA_FIELDCAT TO IT_FIELDCAT.
  CLEAR WA_FIELDCAT.

    WA_FIELDCAT-FIELDNAME = 'CUSTOMER_NUM'.
  WA_FIELDCAT-SELTEXT_M = 'Customer Num'.
  WA_FIELDCAT-COL_POS = 4.
  APPEND WA_FIELDCAT TO IT_FIELDCAT.
  CLEAR WA_FIELDCAT.

    WA_FIELDCAT-FIELDNAME = 'COMPANY_CODE'.
  WA_FIELDCAT-SELTEXT_M = 'Company Code'.
  WA_FIELDCAT-COL_POS = 5.
  APPEND WA_FIELDCAT TO IT_FIELDCAT.
  CLEAR WA_FIELDCAT.

    WA_FIELDCAT-FIELDNAME = 'PIECES'.
  WA_FIELDCAT-SELTEXT_M = 'NO Pecies'.
  WA_FIELDCAT-COL_POS = 6.
  APPEND WA_FIELDCAT TO IT_FIELDCAT.
  CLEAR WA_FIELDCAT.

    WA_FIELDCAT-FIELDNAME = 'TEXT'.
  WA_FIELDCAT-SELTEXT_M = 'Short Text'.
  WA_FIELDCAT-COL_POS = 7.
  APPEND WA_FIELDCAT TO IT_FIELDCAT.
  CLEAR WA_FIELDCAT.
  ENDFORM.


*  DISPLAY FORM
  FORM DISPLAY_DATA.
  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
   EXPORTING

     i_callback_program                = sy-repid
     IT_FIELDCAT                       = IT_FIELDCAT
     I_CALLBACK_TOP_OF_PAGE           = 'TOP'
    TABLES
      T_OUTTAB                          = IT
   EXCEPTIONS
     PROGRAM_ERROR                     = 1
     OTHERS                            = 2
            .
  IF SY-SUBRC <> 0.
* Implement suitable error handling here
  ENDIF.




ENDFORM.


FORM TOP.

  WA_TOP-TYP = 'H'.
  WA_TOP-INFO = 'TASK TABLE'.
  APPEND WA_TOP TO IT_TOP.
  CLEAR WA_TOP.

  CALL FUNCTION 'REUSE_ALV_COMMENTARY_WRITE'
    EXPORTING
     it_list_commentary       = it_top.

ENDFORM.
